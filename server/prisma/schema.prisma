generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// ─── Core Content Models ───────────────────────────────────────────

model Event {
  id            String   @id @default(uuid())
  title         String
  titleAr       String
  description   String
  descriptionAr String
  date          String
  time          String
  location      String
  locationAr    String
  image         String?
  type          String   @default("Event")
  isOnline      Boolean  @default(false)
  meetingLink   String?
  isCompleted   Boolean  @default(false)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model Member {
  id        String   @id @default(uuid())
  name      String
  role      String
  roleAr    String
  office    String
  officeAr  String
  category  String
  term      String
  image     String?
  email     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model News {
  id        String   @id @default(uuid())
  title     String
  content   String
  date      String
  author    String
  tags      String   // JSON array stored as string
  image     String?
  views     Int      @default(0)
  likes     Int      @default(0)
  status    String   @default("published")
  design    String?  // JSON stored as string
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model TimelineItem {
  id      String @id @default(uuid())
  year    String
  titleAr String
  titleEn String
  descAr  String
  descEn  String
  icon    String @default("Layers")
}

model AppSetting {
  id                String  @id @default("main")
  siteNameEn        String  @default("CS Student Association")
  siteNameAr        String  @default("جمعية طلاب الحاسوب")
  logoUrl           String  @default("")
  primaryColor      String  @default("#0284c7")
  secondaryColor    String  @default("#0c4a6e")
  aboutTextAr       String  @default("")
  aboutTextEn       String  @default("")
  visionAr          String  @default("")
  visionEn          String  @default("")
  missionAr         String  @default("")
  missionEn         String  @default("")
  backgroundPattern String  @default("none")
  borderRadius      String  @default("xl")
  animationSpeed    String  @default("normal")
  fontStyle         String  @default("cairo")
  iconStyle         String?
}

// ─── Security & Auth Models ────────────────────────────────────────

model DeanConfig {
  id               String   @id @default("config")
  masterKey        String   // Hashed with bcrypt
  securityQuestion String
  securityAnswer   String
  backupCode       String
  updatedAt        DateTime @updatedAt
}

// Long-lived sessions for Dean access (persistent device recognition)
model DeanSession {
  id          String   @id @default(uuid())
  token       String   @unique // JWT or random token stored on device
  deviceInfo  String   // User-Agent
  ipAddress   String?
  isActive    Boolean  @default(true)
  lastUsed    DateTime @default(now())
  expiresAt   DateTime // Very long expiry (e.g. 365 days)
  createdAt   DateTime @default(now())
}

// Access keys generated by the Dean for admin members
model AccessKey {
  id          String   @id @default(uuid())
  token       String   @unique
  role        String
  generatedAt DateTime @default(now())
  expiresAt   DateTime
  isUsed      Boolean  @default(false)
  generatedBy String   @default("Dean")
}

// Active admin sessions (token-based login)
model AdminSession {
  id          String   @id @default(uuid())
  tokenUsed   String
  role        String
  deviceInfo  String
  ipAddress   String?
  loginTime   DateTime @default(now())
  isActive    Boolean  @default(true)
}
